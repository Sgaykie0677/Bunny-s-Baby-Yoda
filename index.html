<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kids Learning Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center py-10">

    <div class="bg-white p-6 rounded-2xl shadow-xl w-full max-w-4xl mx-auto">
        <h1 class="text-4xl font-bold text-center mb-6 text-gray-800">Learning Center</h1>

        <div class="flex flex-wrap justify-center gap-4 mb-6">
            <button class="tab-button px-6 py-2 rounded-full font-semibold transition-all duration-200 bg-gray-300 text-gray-800" data-tab="plants">Plants</button>
            <button class="tab-button px-6 py-2 rounded-full font-semibold transition-all duration-200" data-tab="shapes">Shapes</button>
            <button class="tab-button px-6 py-2 rounded-full font-semibold transition-all duration-200" data-tab="math">Math</button>
            <button class="tab-button px-6 py-2 rounded-full font-semibold transition-all duration-200" data-tab="phonics">Phonics</button>
            <button class="tab-button px-6 py-2 rounded-full font-semibold transition-all duration-200" data-tab="science">Science</button>
            <button class="tab-button px-6 py-2 rounded-full font-semibold transition-all duration-200" data-tab="french">French</button>
        </div>

        <div id="plants" class="tab-content active p-6 rounded-xl border-2 border-green-300 bg-green-50">
            <h2 class="text-3xl font-bold mb-4 text-green-800 text-center">Plant Growth Story</h2>
            <div class="flex flex-col items-center space-y-4">
                <div id="plant-container" class="relative w-48 h-48 bg-white rounded-full flex items-center justify-center shadow-lg">
                    <span id="plant-emoji" class="text-8xl">ðŸŒ±</span>
                </div>
                <button id="water-button" class="px-6 py-3 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 transition-all duration-200">Water the Plant!</button>
                <div id="story-message" class="text-xl text-gray-700 mt-4 text-center"></div>
                <div id="tts-message" class="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>

        <div id="shapes" class="tab-content p-6 rounded-xl border-2 border-blue-300 bg-blue-50">
            <h2 class="text-3xl font-bold mb-4 text-blue-800 text-center">Shapes Quiz</h2>
            <div class="flex flex-col items-center space-y-6">
                <div id="shape-display" class="w-48 h-48 mx-auto flex items-center justify-center rounded-xl shadow-lg border-2 border-gray-200 bg-white">
                    <!-- Shape will be rendered here -->
                </div>
                <div id="question-text-shapes" class="text-xl font-semibold text-gray-700"></div>
                <div class="space-y-4 w-full">
                    <input type="text" id="shape-input" placeholder="Enter shape name" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200">
                    <input type="text" id="color-input" placeholder="Enter color name" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200">
                    <button id="submit-button-shapes" class="w-full px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition-all duration-200">Submit</button>
                </div>
                <div id="feedback-message-shapes" class="text-xl font-semibold mt-4 text-center"></div>
                <div id="tts-message-shapes" class="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>

        <div id="math" class="tab-content p-6 rounded-xl border-2 border-yellow-300 bg-yellow-50">
            <h2 class="text-3xl font-bold mb-4 text-yellow-800 text-center">Math Problems</h2>
            <div class="flex flex-col items-center space-y-4">
                <div id="math-problem" class="text-4xl font-bold text-gray-800"></div>
                <input type="number" id="math-answer" placeholder="Your Answer" class="w-full max-w-xs px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-500 transition-all duration-200 text-center">
                <button id="check-math" class="px-6 py-3 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-yellow-600 transition-all duration-200">Check Answer</button>
                <div id="math-feedback" class="text-xl font-semibold mt-4"></div>
                <div id="tts-message-math" class="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>

        <div id="phonics" class="tab-content p-6 rounded-xl border-2 border-red-300 bg-red-50">
            <h2 class="text-3xl font-bold mb-4 text-red-800 text-center">Spelling Challenge</h2>
            <div class="flex flex-col items-center space-y-4">
                <div id="word-to-spell" class="text-4xl font-bold text-gray-800"></div>
                <button id="spell-word-button" class="px-6 py-3 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-red-600 transition-all duration-200">Say the Word</button>
                <input type="text" id="spelling-input" placeholder="Spell the word" class="w-full max-w-xs px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500 transition-all duration-200 text-center">
                <button id="check-spelling" class="px-6 py-3 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-red-600 transition-all duration-200">Check Spelling</button>
                <div id="spelling-feedback" class="text-xl font-semibold mt-4"></div>
                <div id="tts-message-phonics" class="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>

        <div id="science" class="tab-content p-6 rounded-xl border-2 border-orange-300 bg-orange-50">
            <h2 class="text-3xl font-bold mb-4 text-orange-800 text-center">Solar System Quiz</h2>
            <div class="flex flex-col items-center space-y-6">
                <img id="science-image" class="w-64 h-64 object-contain rounded-lg shadow-lg" src="" alt="Science object">
                <div id="question-text-science" class="text-xl font-semibold text-gray-700"></div>
                <div class="space-y-4 w-full">
                    <input type="text" id="science-input" placeholder="Enter planet name" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-500 transition-all duration-200">
                    <button id="submit-science" class="w-full px-6 py-3 bg-orange-600 text-white font-semibold rounded-lg shadow-md hover:bg-orange-700 transition-all duration-200">Submit</button>
                </div>
                <div id="feedback-message-science" class="text-xl font-semibold mt-4 text-center"></div>
                <div id="tts-message-science" class="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>

        <div id="french" class="tab-content p-6 rounded-xl border-2 border-pink-300 bg-pink-50">
            <h2 class="text-3xl font-bold mb-4 text-pink-800 text-center">French Vocabulary</h2>
            <div class="flex flex-col items-center space-y-6">
                <div id="french-image" class="w-64 h-64 flex items-center justify-center rounded-lg shadow-lg bg-white">
                    <!-- SVG image will be rendered here -->
                </div>
                <div id="question-text-french" class="text-xl font-semibold text-gray-700"></div>
                <div class="space-y-4 w-full">
                    <input type="text" id="french-input" placeholder="Enter the French word" class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-pink-500 transition-all duration-200">
                    <button id="submit-french" class="w-full px-6 py-3 bg-pink-600 text-white font-semibold rounded-lg shadow-md hover:bg-pink-700 transition-all duration-200">Submit</button>
                </div>
                <div id="feedback-message-french" class="text-xl font-semibold mt-4 text-center"></div>
                <div id="tts-message-french" class="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            const apiUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=';

            function showTab(tabId) {
                tabContents.forEach(tab => tab.classList.remove('active'));
                tabs.forEach(tab => tab.classList.remove('bg-gray-300', 'text-gray-800'));
                
                const activeTab = document.getElementById(tabId);
                const activeButton = document.querySelector(`[data-tab="${tabId}"]`);
                
                if (activeTab && activeButton) {
                    activeTab.classList.add('active');
                    activeButton.classList.add('bg-gray-300', 'text-gray-800');
                }
            }

            async function speakText(text, messageElement) {
                if (!text) {
                    messageElement.textContent = 'Error: No text to speak.';
                    return;
                }
                messageElement.textContent = 'Loading...';
                
                try {
                    const payload = {
                        contents: [{ parts: [{ text: text }] }],
                        generationConfig: {
                            responseModalities: ["AUDIO"],
                            speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: "Puck" } } }
                        },
                        model: "gemini-2.5-flash-preview-tts"
                    };

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const part = result?.candidates?.[0]?.content?.parts?.[0];
                    const audioData = part?.inlineData?.data;
                    const mimeType = part?.inlineData?.mimeType;

                    if (audioData && mimeType && mimeType.startsWith("audio/")) {
                        const sampleRate = parseInt(mimeType.match(/rate=(\d+)/)[1], 10);
                        const pcmData = base64ToArrayBuffer(audioData);
                        
                        const audioCtx = new (window.AudioContext || window.webkitAudioContext)({ sampleRate: sampleRate });
                        const pcm16 = new Int16Array(pcmData);
                        const wavBlob = pcmToWav(pcm16, sampleRate);
                        const audioUrl = URL.createObjectURL(wavBlob);
                        
                        const audio = new Audio(audioUrl);
                        audio.play();
                        messageElement.textContent = '';
                    } else {
                        throw new Error('Invalid audio data received from API.');
                    }
                } catch (error) {
                    console.error('Speech generation failed:', error);
                    messageElement.textContent = 'Error generating speech. Please try again.';
                }
            }

            function base64ToArrayBuffer(base64) {
                const binaryString = atob(base64);
                const len = binaryString.length;
                const bytes = new Uint8Array(len);
                for (let i = 0; i < len; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                return bytes.buffer;
            }

            function pcmToWav(pcmData, sampleRate) {
                const numChannels = 1;
                const bytesPerSample = 2;
                const byteRate = sampleRate * numChannels * bytesPerSample;
                const blockAlign = numChannels * bytesPerSample;
                const dataSize = pcmData.length * bytesPerSample;

                const buffer = new ArrayBuffer(44 + dataSize);
                const view = new DataView(buffer);

                writeString(view, 0, 'RIFF');
                view.setUint32(4, 36 + dataSize, true);
                writeString(view, 8, 'WAVE');
                writeString(view, 12, 'fmt ');
                view.setUint32(16, 16, true);
                view.setUint16(20, 1, true);
                view.setUint16(22, numChannels, true);
                view.setUint32(24, sampleRate, true);
                view.setUint32(28, byteRate, true);
                view.setUint16(32, blockAlign, true);
                view.setUint16(34, bytesPerSample * 8, true);
                writeString(view, 36, 'data');
                view.setUint32(40, dataSize, true);

                let offset = 44;
                for (let i = 0; i < pcmData.length; i++) {
                    view.setInt16(offset, pcmData[i], true);
                    offset += bytesPerSample;
                }
                return new Blob([view], { type: 'audio/wav' });
            }

            function writeString(view, offset, string) {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            }

            // --- Tab Handling ---
            tabs.forEach(button => {
                button.addEventListener('click', () => {
                    showTab(button.dataset.tab);
                });
            });

            // Initial tab display
            showTab('plants');

            // --- Plants Tab Logic ---
            const waterButton = document.getElementById('water-button');
            const plantEmoji = document.getElementById('plant-emoji');
            const storyMessage = document.getElementById('story-message');
            const ttsMessagePlants = document.getElementById('tts-message');

            let plantStage = 0;
            const plantStages = ['ðŸŒ±', 'ðŸŒ¿', 'ðŸª´', 'ðŸŒ³'];
            const stories = [
                'Once upon a time, there was a tiny seed. It was all alone, waiting for a little bit of water to start its great adventure.',
                'The seed drank up the water and stretched out its roots. It pushed up, up, up, and a small sprout appeared. "Hello, world!" it said.',
                'The little plant grew taller and stronger, with bright green leaves reaching for the sun. It loved to play in the sunshine and drink in the rain.',
                'Finally, the plant became a mighty tree! It was big and strong, providing shade and a home for little birds. It was very happy.'
            ];

            waterButton.addEventListener('click', () => {
                if (plantStage < plantStages.length) {
                    plantEmoji.textContent = plantStages[plantStage];
                    storyMessage.textContent = stories[plantStage];
                    speakText(stories[plantStage], ttsMessagePlants);
                    plantStage++;
                } else {
                    storyMessage.textContent = "The plant is fully grown! Let's start a new story.";
                    speakText(storyMessage.textContent, ttsMessagePlants);
                    plantStage = 0;
                }
            });

            // --- Shapes Tab Logic ---
            const shapes = [
                { name: 'triangle', color: 'red', render: `<div class="w-0 h-0 border-l-[6rem] border-r-[6rem] border-b-[10.4rem] border-solid border-l-transparent border-r-transparent border-b-red-500"></div>` },
                { name: 'square', color: 'green', render: `<div class="w-32 h-32 bg-green-500"></div>` },
                { name: 'circle', color: 'blue', render: `<div class="w-32 h-32 bg-blue-500 rounded-full"></div>` },
                { name: 'star', color: 'yellow', render: `<svg class="w-40 h-40" viewBox="0 0 51 48" fill="#facc15" stroke="none"><path d="M25,1.5c-0.6,0-1.2,0.4-1.5,0.9L16.2,16l-14.7,2.1c-0.6,0.1-1.2,0.5-1.5,1.1c-0.3,0.6-0.3,1.3,0,1.9l10.7,10.4l-2.5,14.6c-0.1,0.6,0.1,1.2,0.6,1.6c0.5,0.4,1.1,0.5,1.7,0.3l13.1-6.9l13.1,6.9c0.6,0.2,1.2,0.1,1.7-0.3c0.5-0.4,0.7-1,0.6-1.6l-2.5-14.6l10.7-10.4c0.3-0.6,0.3-1.3,0-1.9c-0.3-0.6-0.9-1-1.5-1.1L34.2,16l-7.3-13.6c-0.3-0.5-0.9-0.9-1.5-0.9z"/></svg>` },
                { name: 'heart', color: 'pink', render: `<svg class="w-40 h-40" viewBox="0 0 24 24" fill="#ec4899" stroke="none"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>` },
                { name: 'hexagon', color: 'purple', render: `<div class="w-32 h-16 bg-purple-600 relative after:content-[''] after:absolute after:bottom-full after:left-0 after:w-0 after:h-0 after:border-b-[1.5rem] after:border-l-[2rem] after:border-r-[2rem] after:border-solid after:border-l-transparent after:border-r-transparent after:border-b-purple-600 before:content-[''] before:absolute before:top-full before:left-0 before:w-0 before:h-0 before:border-t-[1.5rem] before:border-l-[2rem] before:border-r-[2rem] before:border-solid before:border-l-transparent before:border-r-transparent before:border-t-purple-600"></div>` },
                { name: 'diamond', color: 'cyan', render: `<div class="w-24 h-24 transform rotate-45 bg-cyan-400"></div>` },
                { name: 'pentagon', color: 'orange', render: `<div class="relative w-28 h-28 clip-path-polygon-[50%_0%,_100%_38%,_82%_100%,_18%_100%,_0%_38%] bg-orange-400"></div>` },
                { name: 'parallelogram', color: 'lime', render: `<div class="w-48 h-24 transform skew-x-[-20deg] bg-lime-400"></div>` },
                { name: 'cross', color: 'teal', render: `<div class="w-24 h-24 relative bg-teal-400 before:content-[''] before:absolute before:inset-x-0 before:h-24 before:bg-teal-400 after:content-[''] after:absolute after:inset-y-0 after:w-24 after:bg-teal-400"></div>` },
            ];

            const shapeDisplay = document.getElementById('shape-display');
            const shapeInput = document.getElementById('shape-input');
            const colorInput = document.getElementById('color-input');
            const submitButtonShapes = document.getElementById('submit-button-shapes');
            const feedbackMessageShapes = document.getElementById('feedback-message-shapes');
            const questionTextShapes = document.getElementById('question-text-shapes');
            const ttsMessageShapes = document.getElementById('tts-message-shapes');

            let currentShape = null;

            function getRandomShape() {
                const randomIndex = Math.floor(Math.random() * shapes.length);
                return shapes[randomIndex];
            }

            function renderShape() {
                currentShape = getRandomShape();
                shapeDisplay.innerHTML = currentShape.render;
                shapeInput.value = '';
                colorInput.value = '';
                feedbackMessageShapes.textContent = '';
                const question = `What shape is this? What is its color?`;
                questionTextShapes.textContent = question;
                speakText(question, ttsMessageShapes);
            }

            submitButtonShapes.addEventListener('click', () => {
                const guessedShape = shapeInput.value.trim().toLowerCase();
                const guessedColor = colorInput.value.trim().toLowerCase();
                let feedback = '';

                if (guessedShape === currentShape.name && guessedColor === currentShape.color) {
                    feedback = 'Correct! Great job!';
                    feedbackMessageShapes.textContent = feedback;
                    feedbackMessageShapes.className = 'text-green-500 font-semibold mt-4';
                } else {
                    feedback = `Sorry, that's not quite right. The shape was a ${currentShape.name} and the color was ${currentShape.color}. Try again!`;
                    feedbackMessageShapes.textContent = feedback;
                    feedbackMessageShapes.className = 'text-red-500 font-semibold mt-4';
                }
                speakText(feedback, ttsMessageShapes);
                setTimeout(renderShape, 3000);
            });
            
            document.querySelector('[data-tab="shapes"]').addEventListener('click', renderShape);

            // --- Math Tab Logic ---
            const mathProblem = document.getElementById('math-problem');
            const mathAnswerInput = document.getElementById('math-answer');
            const checkMathButton = document.getElementById('check-math');
            const mathFeedback = document.getElementById('math-feedback');
            const ttsMessageMath = document.getElementById('tts-message-math');

            let currentProblem = null;

            function generateMathProblem() {
                const num1 = Math.floor(Math.random() * 10) + 1;
                const num2 = Math.floor(Math.random() * 10) + 1;
                const operator = Math.random() < 0.5 ? '+' : '-';
                const problem = `${num1} ${operator} ${num2}`;
                
                mathProblem.textContent = problem;
                mathAnswerInput.value = '';
                mathFeedback.textContent = '';
                currentProblem = eval(problem);
                
                speakText(`What is ${num1} ${operator === '+' ? 'plus' : 'minus'} ${num2}?`, ttsMessageMath);
            }

            checkMathButton.addEventListener('click', () => {
                const answer = parseInt(mathAnswerInput.value, 10);
                let feedback = '';

                if (answer === currentProblem) {
                    feedback = "That's correct! Great job!";
                    mathFeedback.textContent = feedback;
                    mathFeedback.className = 'text-green-500 font-semibold mt-4';
                    setTimeout(generateMathProblem, 2000);
                } else {
                    feedback = `Sorry, the correct answer is ${currentProblem}. Please try again.`;
                    mathFeedback.textContent = feedback;
                    mathFeedback.className = 'text-red-500 font-semibold mt-4';
                }
                speakText(feedback, ttsMessageMath);
            });
            
            document.querySelector('[data-tab="math"]').addEventListener('click', generateMathProblem);

            // --- Phonics Tab Logic ---
            const words = ["cat", "dog", "sun", "hat", "bed"];
            const wordToSpell = document.getElementById('word-to-spell');
            const spellWordButton = document.getElementById('spell-word-button');
            const spellingInput = document.getElementById('spelling-input');
            const checkSpellingButton = document.getElementById('check-spelling');
            const spellingFeedback = document.getElementById('spelling-feedback');
            const ttsMessagePhonics = document.getElementById('tts-message-phonics');

            let currentWord = '';

            function getRandomWord() {
                const randomIndex = Math.floor(Math.random() * words.length);
                return words[randomIndex];
            }

            function startSpellingChallenge() {
                currentWord = getRandomWord();
                wordToSpell.textContent = 'Spell this word!';
                spellingInput.value = '';
                spellingFeedback.textContent = '';
                speakText(`Spell the word: ${currentWord}.`, ttsMessagePhonics);
            }

            spellWordButton.addEventListener('click', () => {
                if (currentWord) {
                    speakText(currentWord, ttsMessagePhonics);
                }
            });

            checkSpellingButton.addEventListener('click', () => {
                const userSpelling = spellingInput.value.trim().toLowerCase();
                let feedback = '';

                if (userSpelling === currentWord) {
                    feedback = 'You spelled it correctly! Fantastic!';
                    spellingFeedback.textContent = feedback;
                    spellingFeedback.className = 'text-green-500 font-semibold mt-4';
                } else {
                    feedback = `Oops, that's not right. The correct spelling is ${currentWord}. Try again!`;
                    spellingFeedback.textContent = feedback;
                    spellingFeedback.className = 'text-red-500 font-semibold mt-4';
                }
                speakText(feedback, ttsMessagePhonics);
                setTimeout(startSpellingChallenge, 3000);
            });
            
            document.querySelector('[data-tab="phonics"]').addEventListener('click', startSpellingChallenge);

            // --- Science Tab Logic ---
            const scienceImage = document.getElementById('science-image');
            const scienceInput = document.getElementById('science-input');
            const submitScienceButton = document.getElementById('submit-science');
            const feedbackMessageScience = document.getElementById('feedback-message-science');
            const questionTextScience = document.getElementById('question-text-science');
            const ttsMessageScience = document.getElementById('tts-message-science');

            const planets = [
                { name: 'mercury', image: 'https://placehold.co/256x256/f79220/ffffff?text=Mercury' },
                { name: 'venus', image: 'https://placehold.co/256x256/f7c16c/000000?text=Venus' },
                { name: 'earth', image: 'https://placehold.co/256x256/4a90e2/ffffff?text=Earth' },
                { name: 'mars', image: 'https://placehold.co/256x256/c0522c/ffffff?text=Mars' },
                { name: 'jupiter', image: 'https://placehold.co/256x256/d1a774/000000?text=Jupiter' },
                { name: 'saturn', image: 'https://placehold.co/256x256/d1c990/000000?text=Saturn' },
                { name: 'uranus', image: 'https://placehold.co/256x256/c1e8e8/000000?text=Uranus' },
                { name: 'neptune', image: 'https://placehold.co/256x256/4169e1/ffffff?text=Neptune' }
            ];

            let currentPlanet = null;

            function renderScienceQuestion() {
                const randomIndex = Math.floor(Math.random() * planets.length);
                currentPlanet = planets[randomIndex];
                scienceImage.src = currentPlanet.image;
                scienceInput.value = '';
                feedbackMessageScience.textContent = '';
                const question = "Can you name this planet?";
                questionTextScience.textContent = question;
                speakText(question, ttsMessageScience);
            }

            submitScienceButton.addEventListener('click', () => {
                const guessedPlanet = scienceInput.value.trim().toLowerCase();
                let feedback = '';

                if (guessedPlanet === currentPlanet.name) {
                    feedback = "That's correct! Way to go!";
                    feedbackMessageScience.textContent = feedback;
                    feedbackMessageScience.className = 'text-green-500 font-semibold mt-4';
                } else {
                    feedback = `Sorry, that's not right. The correct answer is ${currentPlanet.name}. Try again!`;
                    feedbackMessageScience.textContent = feedback;
                    feedbackMessageScience.className = 'text-red-500 font-semibold mt-4';
                }
                speakText(feedback, ttsMessageScience);
                setTimeout(renderScienceQuestion, 3000);
            });

            document.querySelector('[data-tab="science"]').addEventListener('click', renderScienceQuestion);

            // --- French Tab Logic ---
            const frenchImageContainer = document.getElementById('french-image');
            const frenchInput = document.getElementById('french-input');
            const submitFrenchButton = document.getElementById('submit-french');
            const feedbackMessageFrench = document.getElementById('feedback-message-french');
            const questionTextFrench = document.getElementById('question-text-french');
            const ttsMessageFrench = document.getElementById('tts-message-french');

            const frenchWords = [
                { english: 'dog', french: 'chien', svg: `<svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M22.5 12c0 5.8-4.7 10.5-10.5 10.5S1.5 17.8 1.5 12 6.2 1.5 12 1.5 22.5 6.2 22.5 12z"/><path d="M12 15c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z"/><path d="M12 9c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z" opacity=".2"/><path d="M12 18c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z" opacity=".2"/><path d="M12 6c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z" opacity=".2"/><path d="M15 12c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z" opacity=".2"/></svg>` },
                { english: 'car', french: 'voiture', svg: `<svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-car"><path d="M16 17a2 2 0 01-2 2H6a2 2 0 01-2-2V7a2 2 0 012-2h8a2 2 0 012 2v10z"/><path d="M12 17h10M12 7h10"/></svg>` },
                { english: 'house', french: 'maison', svg: `<svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>` }
            ];

            let currentFrenchWord = null;

            function renderFrenchQuestion() {
                const randomIndex = Math.floor(Math.random() * frenchWords.length);
                currentFrenchWord = frenchWords[randomIndex];
                frenchImageContainer.innerHTML = currentFrenchWord.svg;
                frenchInput.value = '';
                feedbackMessageFrench.textContent = '';
                const question = `What is the French word for this?`;
                questionTextFrench.textContent = question;
                speakText(question, ttsMessageFrench);
            }

            submitFrenchButton.addEventListener('click', () => {
                const guessedWord = frenchInput.value.trim().toLowerCase();
                let feedback = '';

                if (guessedWord === currentFrenchWord.french) {
                    feedback = `C'est correct! That's right!`;
                    feedbackMessageFrench.textContent = feedback;
                    feedbackMessageFrench.className = 'text-green-500 font-semibold mt-4';
                } else {
                    feedback = `DÃ©solÃ©, that's not quite right. The correct word is ${currentFrenchWord.french}. Try again!`;
                    feedbackMessageFrench.textContent = feedback;
                    feedbackMessageFrench.className = 'text-red-500 font-semibold mt-4';
                }
                speakText(feedback, ttsMessageFrench);
                setTimeout(renderFrenchQuestion, 3000);
            });

            document.querySelector('[data-tab="french"]').addEventListener('click', renderFrenchQuestion);

        });
    </script>
</body>
</html>
